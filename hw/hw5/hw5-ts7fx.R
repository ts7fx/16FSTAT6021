## Tianye Song, ts7fx
## STAT 6021, HW5
## 10/5/2016
library(gdata)
## 6.12, 6.13, 6.14, 6.15, 8.5, 8.6
setwd("~/Documents/16FSTAT6021/hw/hw5")
#6.12
data.6.12 <- read.xls("data-table-B11.xls")
lm.6.12 <- lm(Quality~.-Region, data = data.6.12)
summary(lm.6.12)
print(influence.measures(lm.6.12))
#      dfb.1_  dfb.Clrt  dfb.Arom  dfb.Body  dfb.Flvr  dfb.Okns    dffit cov.r   cook.d    hat inf
# 1   0.05892 -0.003669 -0.005540 -0.072839 -0.004244  0.008985  0.12166 1.437 2.54e-03 0.1699    
# 2  -0.12222  0.243712  0.075373  0.378178 -0.413134 -0.141098  0.57333 1.043 5.36e-02 0.1606    
# 3   0.03560 -0.034162  0.047815 -0.040803 -0.011298 -0.011128 -0.06638 1.448 7.58e-04 0.1680    
# 4   0.30978 -0.047179  0.156272 -0.360434 -0.079163 -0.096486  0.53408 1.297 4.76e-02 0.2257    
# 5   0.01067 -0.005144 -0.000283 -0.001859 -0.002517 -0.009178 -0.01745 1.309 5.24e-05 0.0761    
# 6   0.00525 -0.009598  0.008255 -0.002851 -0.006725  0.004208 -0.01657 1.282 4.72e-05 0.0573    
# 7   0.01914 -0.086736  0.019475 -0.049395 -0.006234  0.122699 -0.15946 1.299 4.34e-03 0.1063    
# 8  -0.03033  0.007070  0.059673 -0.003661 -0.065853  0.078708  0.12971 1.324 2.88e-03 0.1101    
# 9   0.08189  0.243017  0.021861  0.124660 -0.143811 -0.468736  0.58651 1.008 5.58e-02 0.1554    
# 10  0.08092  0.114739 -0.142125 -0.209366  0.227016 -0.115757  0.43459 0.883 3.04e-02 0.0813    
# 11  0.05180  0.137701  0.160284 -0.053660 -0.083974 -0.255697  0.42520 0.865 2.90e-02 0.0755    
# 12  0.82787 -0.968715 -0.397673  0.229029 -0.006034 -0.044001  1.38321 1.162 3.01e-01 0.3947   *
# 13  0.00561 -0.051015 -0.053092 -0.025170  0.155749 -0.028540  0.21181 1.451 7.67e-03 0.1956    
# 14 -0.02936  0.110125 -0.158014 -0.045912  0.045892  0.076656 -0.27773 1.839 1.32e-02 0.3592   *
# 15  0.02210 -0.015593  0.228302 -0.156845 -0.001107 -0.052567  0.30691 1.498 1.60e-02 0.2378    
# 16 -0.15509  0.044243 -0.035670  0.202154  0.040864 -0.003327  0.38858 0.836 2.42e-02 0.0611    
# 17 -0.07846  0.047156  0.129021  0.080673 -0.131947  0.008753  0.19638 1.384 6.59e-03 0.1593    
# 18  0.01337 -0.014428  0.010422 -0.013862 -0.005939  0.006591 -0.02312 1.360 9.19e-05 0.1111    
# 19 -0.09957 -0.148007 -0.042729  0.042382  0.015649  0.336828 -0.42964 1.054 3.04e-02 0.1173    
# 20 -0.03809 -0.382936  0.457362 -1.064555  0.654187  0.604564 -1.53525 0.302 3.10e-01 0.1983   *
# 21 -0.00047 -0.000352  0.000277 -0.000534  0.001165  0.000505  0.00224 1.383 8.65e-07 0.1252    
# 22  0.06375 -0.085433 -0.006223 -0.072255  0.005300  0.080199 -0.14802 1.272 3.74e-03 0.0893    
# 23 -0.64432  0.611462 -0.083077  0.502961 -0.237435  0.066842 -0.77426 0.997 9.61e-02 0.2079    
# 24 -0.49142  0.477655 -0.064590  0.281835  0.007088 -0.063506 -0.55917 1.119 5.14e-02 0.1776    
# 25  0.25079 -0.155733 -0.073235 -0.117280 -0.010600 -0.049554 -0.37942 0.947 2.35e-02 0.0770    
# 26  0.02088 -0.019297  0.027670 -0.006945 -0.012191 -0.025578 -0.05192 1.299 4.63e-04 0.0748    
# 27  0.00375 -0.004278  0.022441  0.013542 -0.024271 -0.016969 -0.03648 1.487 2.29e-04 0.1873    
# 28  0.07914 -0.044644  0.013062 -0.025420  0.000506 -0.086584 -0.14120 1.234 3.40e-03 0.0689    
# 29  0.09523 -0.184589  0.383809  0.025424 -0.319647 -0.037199 -0.48837 0.974 3.88e-02 0.1164    
# 30 -0.20516 -0.054783 -0.452379  0.044330  0.616863  0.104723 -0.80211 0.865 1.01e-01 0.1817    
# 31  0.11558  0.038062 -0.030180  0.174710 -0.050485 -0.444442 -0.51396 1.245 4.40e-02 0.2026    
# 32 -0.03594  0.038201 -0.028538  0.017013  0.038874 -0.026353 -0.06522 1.569 7.31e-04 0.2309   *
# 33  0.07433  0.069428 -0.325392 -0.232789  0.288122  0.118699  0.52536 1.098 4.54e-02 0.1608    
# 34 -0.06003  0.001634  0.099803 -0.051993  0.007949  0.072140  0.18289 1.381 5.72e-03 0.1544    
# 35 -0.01829 -0.051016 -0.049192  0.061280  0.024481  0.062038  0.15841 1.294 4.29e-03 0.1036    
# 36  0.11743 -0.045309 -0.122647  0.057462  0.024651 -0.114071  0.24573 1.278 1.03e-02 0.1262    
# 37 -0.06069 -0.152757  0.043327  0.277490 -0.365286  0.391474  0.61410 1.717 6.36e-02 0.3753   *
# 38 -0.12936  0.106901  0.011619  0.094098 -0.134312  0.111034 -0.25243 1.255 1.08e-02 0.1194 

## Cook's D does not indicate any influential points. Thus no influential observations are spotted.

#6.13
data.6.13 <- read.xls("data-table-B12.xls")
lm.6.13 <- lm(pitch~., data = data.6.13)
summary(lm.6.13)
print(influence.measures(lm.6.13))

#      dfb.1_ dfb.temp dfb.sktm dfb.skpc  dfb.dfft dfb.dffp   dffit cov.r   cook.d    hat inf
# 1   0.08703 -0.11595  0.04983  0.02296  0.174375 -0.04418 -0.3517 1.188 2.07e-02 0.1277    
# 2  -0.01103  0.01526 -0.00902 -0.00564 -0.017976  0.00923  0.0452 1.419 3.54e-04 0.1121    
# 3   0.02943 -0.04070  0.02405  0.01505  0.047954 -0.02462 -0.1207 1.386 2.51e-03 0.1121    
# 4  -0.03899  0.04785 -0.02202 -0.01673 -0.010966  0.06263  0.1044 1.501 1.88e-03 0.1678    
# 5   0.17548 -0.22875  0.17904  0.03188 -0.063465  0.01651  0.3693 1.846 2.34e-02 0.3542   *
# 6   0.37522 -0.48911  0.38282  0.06817 -0.135702  0.03530  0.7897 1.500 1.03e-01 0.3542    
# 7  -0.14068  0.08271  0.14262  0.07858  0.391353  0.43472 -0.6827 0.750 7.22e-02 0.1363    
# 8   0.08768 -0.05723 -0.07432 -0.04996 -0.191665 -0.22931  0.3598 1.123 2.16e-02 0.1131    
# 9  -0.05262  0.03622  0.03488  0.02418  0.120797  0.13974 -0.2157 1.303 7.94e-03 0.1111    
# 10 -0.01204  0.00829  0.00798  0.00553  0.027636  0.03197 -0.0493 1.417 4.22e-04 0.1111    
# 11 -0.06356  0.09706 -0.09660 -0.08820 -0.006947  0.14379  0.2998 1.096 1.50e-02 0.0837    
# 12 -0.00351  0.00536 -0.00533 -0.00487 -0.000383  0.00794  0.0165 1.380 4.74e-05 0.0837    
# 13 -0.21656  0.17418  0.11482  0.23859 -0.145692  0.05285  0.3016 1.462 1.55e-02 0.2044    
# 14 -0.05140  0.03274  0.02344  0.09773 -0.033795 -0.04477  0.1327 1.401 3.04e-03 0.1235    
# 15  0.03475 -0.01870 -0.03867 -0.07787  0.043509  0.03690 -0.0930 1.483 1.50e-03 0.1564    
# 16  0.04146 -0.03084 -0.04341 -0.04676  0.028795 -0.02234  0.0857 1.322 1.27e-03 0.0660    
# 17 -0.10462  0.08078  0.09470  0.10941 -0.065500  0.05841 -0.2100 1.150 7.45e-03 0.0616    
# 18 -0.04547  0.03511  0.04116  0.04756 -0.028470  0.02539 -0.0913 1.308 1.44e-03 0.0616    
# 19  0.20013 -0.10307 -0.21997 -0.44942  0.192486  0.18443 -0.5424 0.982 4.76e-02 0.1431    
# 20  0.00355 -0.01010  0.02817  0.03298 -0.047946 -0.05323 -0.0693 1.458 8.32e-04 0.1385    
# 21 -0.01607  0.04576 -0.12765 -0.14943  0.217243  0.24118  0.3141 1.270 1.67e-02 0.1385    
# 22 -0.02615 -0.05712  0.43070  0.46747 -0.796468 -0.65324 -0.9059 1.235 1.33e-01 0.3184    
# 23  0.15459 -0.05979 -0.15811 -0.35108 -0.099024  0.02259 -0.5530 0.982 4.95e-02 0.1467    
# 24 -0.20555  0.18959  0.08013  0.10443 -0.068937  0.21381 -0.3241 1.490 1.79e-02 0.2221    
# 25 -0.36506  0.32220  0.21850  0.28195 -0.305253  0.21414 -0.6074 0.889 5.88e-02 0.1433    
# 26  0.06589 -0.04364 -0.01726 -0.06964 -0.101902 -0.08431 -0.1847 1.558 5.88e-03 0.2120    
# 27  0.10909 -0.09208 -0.08846 -0.12776  0.186835  0.02859  0.2427 1.294 1.00e-02 0.1189    
# 28 -1.15933  1.24015 -0.37671  0.49978 -0.017016  0.03885  1.5104 0.901 3.45e-01 0.3830   *
# 29  1.33285 -1.31075 -0.11346 -0.43810  0.250189 -1.44868  2.0640 0.081 4.49e-01 0.2092   *
# 30 -0.10457  0.05832  0.10415  0.15750  0.065405  0.08715  0.2553 1.480 1.12e-02 0.1974    
# 31  0.01698  0.03777  0.07244 -0.17029  0.028159  0.03879  0.4636 1.748 3.67e-02 0.3436   *
# 32 -0.00085  0.11393 -1.77993 -0.31509  0.648682  0.03266 -2.4005 3.138 9.26e-01 0.7446   *

## observation #32 has a cook's D of 9.26.
## look at dfb for obs #32. 2/sqrt(n) = 0.354 in this case. absolute values for dfbetas for both sktm and dfft exceeded 0.354. 
## thus, observation #32 is an influential point.

#6.14
data.6.14 <- read.xls("data-table-B13.xls")
lm.6.14 <- lm(y~., data = data.6.14)
summary(lm.6.14)
print(influence.measures(lm.6.14))
  
#   dfb.1_    dfb.x1   dfb.x2   dfb.x3   dfb.x4   dfb.x5    dfb.x6    dffit cov.r   cook.d    hat inf
# 1   0.02761  2.56e-03  0.02817 -0.02960 -0.00434  0.02318  0.008214 -0.05760 1.419 4.88e-04 0.1299    
# 2   0.02852 -2.11e-01  0.04675 -0.04408  0.31316 -0.11622  0.314973  0.59480 0.829 4.83e-02 0.1225    
# 3  -0.01891 -4.39e-03 -0.00189  0.01890 -0.00120 -0.02322 -0.007901  0.03429 1.319 1.73e-04 0.0634    
# 4  -0.02684 -7.97e-02  0.01580  0.02717  0.09051 -0.10013  0.064448  0.24607 1.132 8.71e-03 0.0728    
# 5   0.11094 -7.33e-02  0.13856 -0.14262  0.06516  0.21285  0.029163 -0.35330 1.271 1.80e-02 0.1564    
# 6   0.02299 -7.48e-02  0.07823 -0.03888  0.06542  0.01067  0.090183 -0.19631 1.738 5.66e-03 0.3001   *
# 7   0.05077  2.39e-01 -0.17812  0.00388 -0.15212 -0.02992 -0.153529  0.62009 1.205 5.44e-02 0.2251    
# 8  -0.00341  7.10e-04 -0.00104  0.00320 -0.00226 -0.00243  0.000127 -0.01108 1.509 1.81e-05 0.1783    
# 9   0.01120 -7.21e-02 -0.00040 -0.01272  0.07052  0.06096 -0.052403  0.18954 1.655 5.28e-03 0.2664   *
# 10 -0.05966 -9.83e-03  0.04810  0.04544 -0.00514 -0.11412  0.095858 -0.32050 1.721 1.50e-02 0.3136   *
# 11  0.85668  1.45e+00  0.21456 -0.75304 -1.15392  0.07874  0.480069  1.65456 1.389 3.71e-01 0.4987   *
# 12 -0.18556  6.71e-02 -0.06406  0.19799 -0.15103 -0.18340 -0.190573 -0.28222 1.332 1.16e-02 0.1537    
# 13 -0.04583  1.53e-02 -0.02705  0.04954 -0.03138 -0.03867 -0.046259 -0.06294 1.479 5.83e-04 0.1648    
# 14  0.26145  5.49e-02  0.11737 -0.26354  0.03461  0.15474  0.237253  0.33025 1.148 1.56e-02 0.1088    
# 15  0.10390  3.93e-02 -0.00161 -0.09689  0.01160  0.06121  0.096856  0.15178 1.543 3.38e-03 0.2111    
# 16  0.01397  3.08e-02 -0.00209 -0.00807 -0.00542 -0.05204  0.048939  0.10499 1.567 1.62e-03 0.2153    
# 17  0.04149  8.07e-02 -0.03818 -0.04134 -0.11713  0.19302 -0.109980 -0.40362 1.088 2.31e-02 0.1193    
# 18  0.11905  6.19e-02 -0.00544 -0.11901 -0.02982  0.16819  0.050013 -0.25559 1.233 9.46e-03 0.1065    
# 19 -0.03888 -4.28e-02  0.01638  0.03663  0.02711 -0.05658 -0.010608  0.10138 1.421 1.51e-03 0.1390    
# 20 -1.50963 -8.85e-01 -4.41217  1.76135  1.62564  1.41206 -1.178345 -5.12571 0.818 3.01e+00 0.7409   *
# 21  0.12890 -5.36e-01  0.07133 -0.14577  0.65611  0.06420  0.285208 -0.95340 0.566 1.17e-01 0.1617    
# 22  0.12991 -1.04e-02  0.03011 -0.11976  0.09146  0.00280  0.151587 -0.27460 1.150 1.08e-02 0.0883    
# 23  0.20270  6.28e-02 -0.00836 -0.17959  0.07484  0.02956  0.206351 -0.35016 1.048 1.74e-02 0.0907    
# 24  0.22696  7.43e-02 -0.04416 -0.20295  0.10093  0.06346  0.250286 -0.40187 1.127 2.30e-02 0.1291    
# 25  0.19779 -1.99e-01  0.38249 -0.24909  0.22901  0.06453  0.230982 -0.67189 1.008 6.27e-02 0.1877    
# 26 -0.12266  8.09e-02  0.04757  0.10419 -0.20859  0.02549 -0.226970  0.42248 1.201 2.55e-02 0.1583    
# 27 -0.05716 -3.32e-02  0.22674  0.00594 -0.13508  0.13581 -0.184236  0.56349 0.762 4.30e-02 0.1007    
# 28 -0.53307 -3.12e-01  0.24024  0.44525 -0.10684 -0.14339 -0.530016  0.89251 0.574 1.03e-01 0.1488    
# 29 -0.41582 -1.98e-01  0.13689  0.36216 -0.13340 -0.12900 -0.428970  0.75550 0.622 7.48e-02 0.1250    
# 30 -0.05800  9.30e-02 -0.10012  0.07522 -0.11668 -0.02822 -0.090691  0.25973 1.371 9.83e-03 0.1616    
# 31  0.03923  4.11e-02  0.08609 -0.04101 -0.09890  0.06677 -0.121880 -0.35889 1.111 1.84e-02 0.1094    
# 32  0.01446 -2.31e-05  0.00946 -0.01507 -0.00105  0.02106 -0.006087 -0.04407 1.328 2.86e-04 0.0712    
# 33 -0.05778 -1.86e-01 -0.02033  0.04316  0.19809 -0.01721  0.077690  0.27160 1.258 1.07e-02 0.1217    
# 34  0.02063  6.88e-03  0.02155 -0.02226 -0.00617  0.01627  0.004340 -0.03849 1.414 2.18e-04 0.1250    
# 35  0.03544  8.01e-02 -0.10743 -0.01259 -0.02236 -0.01571  0.061807  0.21055 1.549 6.50e-03 0.2254    
# 36 -0.06660  7.71e-02  0.00551  0.08468 -0.09435 -0.22412 -0.014152 -0.30494 1.305 1.35e-02 0.1513    
# 37 -0.19071  3.32e-01 -0.09504  0.25034 -0.35294 -0.56662 -0.066204 -0.68911 0.998 6.58e-02 0.1903    
# 38 -0.00114  4.80e-03 -0.00172  0.00189 -0.00459 -0.00458 -0.000891 -0.00681 1.473 6.83e-06 0.1581    
# 39 -0.01338 -2.50e-02  0.01875  0.00821  0.00314  0.00751 -0.009393  0.14045 1.189 2.87e-03 0.0457    
# 40 -0.03216  3.96e-03  0.02039  0.02944 -0.02387 -0.03981 -0.028972 -0.08199 1.471 9.89e-04 0.1633

# observation # 20 shows high value for cook's D and abs(DFbeta) for multiple regressors.
# observation #20 is an influential point.

#6.15
data.6.15 <- read.xls("data-table-B14.xls")
lm.6.15 <- lm(y~.-x5, data = data.6.15)
summary(lm.6.15)
print(influence.measures(lm.6.15))
#      dfb.1_   dfb.x1    dfb.x2   dfb.x3   dfb.x4   dffit  cov.r   cook.d    hat inf
# 1  -0.27473  0.16496  0.041363  0.08873  0.10301 -0.2959 1.2432 0.017835 0.1199    
# 2   1.67378  0.20782 -3.770434  0.04699 -1.06808 -4.6687 0.0364 1.982003 0.4659   *
# 3  -0.03129  0.04674  0.024425 -0.01615 -0.02710 -0.1157 1.3434 0.002797 0.0774    
# 4  -0.58847  0.19926 -0.567155 -0.93671  2.33591  2.4964 0.9122 1.040067 0.5564   *
# 5   0.02667 -0.06634  0.056544 -0.05955 -0.01604 -0.1391 1.2885 0.004013 0.0661    
# 6  -0.05030  0.04955  0.206576 -0.04693  0.01743  0.2795 1.3967 0.016115 0.1652    
# 7  -0.07085 -0.01964  0.019903  0.03718  0.03362 -0.1249 1.3180 0.003249 0.0707    
# 8   0.40973 -0.60494  1.455753 -0.54208 -0.29155  1.5711 0.6198 0.413379 0.3357   *
# 9  -0.13022 -0.08612 -0.111518  1.04974 -0.51436  1.1547 1.3767 0.255395 0.4146   *
# 10  0.18758 -0.27570  0.066515 -0.18920  0.02154 -0.3344 1.9809 0.023318 0.3782   *
# 11 -0.07111 -0.06542 -0.001061  0.09485  0.14683  0.3068 1.2995 0.019235 0.1419    
# 12 -0.04985 -0.02498  0.046602  0.01780  0.01969 -0.0997 1.3796 0.002081 0.0882    
# 13 -0.12754  0.08889 -0.018935  0.05119  0.05256 -0.1364 1.4166 0.003888 0.1198    
# 14  0.31669 -0.35325 -0.007172  0.59518 -0.58718  0.9188 0.6567 0.148917 0.1868    
# 15  0.00156 -0.00623  0.000792 -0.01761  0.02747  0.0357 1.5380 0.000269 0.1612    
# 16 -0.25158  0.08497  0.061048  0.09861  0.11865 -0.2788 1.3193 0.015957 0.1373    
# 17 -0.34088  0.21985  0.034316  0.16651  0.08882 -0.3617 1.3248 0.026658 0.1716    
# 18  0.02645  0.01519  0.062897 -0.04094 -0.02552  0.1073 1.4544 0.002414 0.1293    
# 19 -0.03880  0.27715 -0.101053 -0.06482  0.02903  0.3471 1.5705 0.024887 0.2508    
# 20 -0.03855  0.27540 -0.100416 -0.06442  0.02885  0.3449 1.5723 0.024579 0.2508    
# 21 -0.01037 -0.02207  0.018493  0.00536  0.00495 -0.0420 1.4388 0.000371 0.1053    
# 22  0.32655 -0.22812  0.118384 -0.16290 -0.16659  0.3513 1.3998 0.025290 0.1927    
# 23 -0.05043 -0.00382  0.066659 -0.09667  0.06343 -0.1910 1.2009 0.007467 0.0637    
# 24 -0.03327  0.09068  0.165029 -0.20315 -0.01078 -0.3570 1.2856 0.025907 0.1574    
# 25  0.04700  0.00215  0.114694 -0.08991 -0.10662 -0.2227 1.5172 0.010328 0.1931

# by cook's D, observation #2 and #4 are influential points.

#8.5
data.8.5 <- read.xls("data-table-B3.xls")
lm.8.5 <- lm(y~x10+x11, data = data.8.5)
summary(lm.8.5)
# Coefficients:
#                 Estimate Std. Error t value Pr(>|t|)    
#   (Intercept) 39.1919052  2.5570509  15.327 1.92e-15 ***
#   x10         -0.0047484  0.0009544  -4.975 2.72e-05 ***
#   x11         -2.6958431  1.9805597  -1.361    0.184  
# note that for x11(type of transmission), p value is 0.184. Thus, x11 is not a significant regressor. 

data.8.5$x10x11 <- data.8.5$x10 * data.8.5$x11
lm.8.5b <- lm(y~x10+x11+x10x11, data = data.8.5)
summary(lm.8.5b)
# Coefficients:
#   Estimate Std. Error t value Pr(>|t|)    
#   (Intercept)  58.108420   5.077985  11.443 4.53e-12 ***
#   x10          -0.012517   0.002055  -6.090 1.44e-06 ***
#   x11         -26.724910   6.107349  -4.376 0.000152 ***
#   x10x11        0.009035   0.002217   4.076 0.000342 ***
# the new model is y = 58.1 - 0.0125x10 - 26.7x11 + 0.009x10x11
# with x11 = 0, i.e. when the transmission is manual
# y = 58.1 - 0.0125x10, this means for a manual transmission vehicle, every unit increase in its weight leads to a .0125 decrease in its gasoline mileage.
# x11 = 1, i.e. when the transmission is automatic
# y = 31.4 - 0.0215x10, this means for a automatic transmission vehicle, every unit increase in its weight leads to a .0215 decrease in its gasoline mileage.

#8.6
data.8.6 <- read.xls("data-table-B1.xls")
lm.8.6 <- lm(y~x8+x7+x5, data=data.8.6)
summary(lm.8.6)
# modify x5 by adding
# x5 x66 x99
#  0   0   0
#  -   1   0
#  +   0   1

data.8.6$x66  <- as.numeric(sign(data.8.6$x5)==-1)
data.8.6$x99  <- as.numeric(sign(data.8.6$x5)==1)
# now do regression, substitute x5 with x66 & x99
lm.8.6b <- lm(y~x8+x7+x66+x99, data = data.8.6)
summary(lm.8.6b)
anova(lm.8.6b)

# Analysis of Variance Table
# 
# Response: y
#           Df  Sum Sq Mean Sq F value    Pr(>F)    
# x8         1 178.092 178.092 32.6066 8.159e-06 ***
# x7         1   0.974   0.974  0.1783    0.6768    
# x66        1  17.457  17.457  3.1961    0.0870 .  
# x99        1   4.819   4.819  0.8823    0.3573    
# Residuals 23 125.622   5.462                    

# test-statistic F0 for this new model is ((17.457+4.819)/2)/5.462 = 2.04, which is insignificant.






